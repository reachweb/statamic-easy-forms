<form
    method="{{ method }}"
    action="{{ action }}"
    x-data="formHandler('{{ event_name }}')"
    x-ref="form"
    x-on:submit.prevent="formSubmit"
    x-on:fields-changed="updateSubmitData($event.detail)"
    data-csrf-token="{{ csrf_token }}"
>
    {{ csrf_field }}

    {{# Honeypot field #}}
    {{ if honeypot }}
    <input type="text" name="{{ honeypot }}" class="hidden" tabindex="-1" autocomplete="off">
    {{ /if }}

    <div
        class="grid grid-cols-12 gap-x-6"
        x-data="formFields({{ fields | to_json | entities }}, '{{ honeypot }}', {{ hide_fields | to_json | entities ?? '[]' }}, {{ prepopulated_data | to_json | entities ?? '[]' }})"
        x-show="! successMessage"
        x-transition.opacity
    >
    {{ fields }}
    <div
        class="py-2 lg:py-3 {{ if honeypot === handle || input_type === 'hidden' }}hidden{{ /if }}
        {{ if width === 50 }}col-span-12 md:col-span-6{{ elseif width === 33 }}col-span-12 md:col-span-4{{ elseif width === 25 }}col-span-12 md:col-span-3{{ else }}col-span-12{{ /if }}"
        x-show="shouldShowField('{{ handle }}')"
    >
        {{ unless type === 'toggle' || type === 'spacer' }}
        <div class="flex items-center mb-2">
            <label class="uppercase block font-semibold text-sm text-gray-900" for="{{ handle }}">
                {{ display }}
            </label>
            {{ if optional }}
            <span class="ml-2 text-sm">
                ({{ "Optional" | trans }})
            </span>
            {{ /if }}
        </div>
        {{ /unless }}

        {{ if instructions && (instructions_position === 'above' || ! instructions_position) && type !== 'toggle' && type !== 'spacer' }}
        <div class="mb-3 text-sm">
            {{ instructions }}
        </div>
        {{ /if }}

        {{# Simple text input #}}
        {{ if (input_type == 'text' && type == 'text') || (input_type == 'email' && type == 'text') }}
        <div>
            {{ partial:statamic-easy-forms::form/fieldtypes/text }}
        </div>
        {{ /if }}

        {{# Date #}}
        {{ if input_type == 'date' && type == 'text' }}
        <div>
            {{ partial:statamic-easy-forms::form/fieldtypes/date }}
        </div>
        {{ /if }}

        {{# Time #}}
        {{ if input_type == 'time' && type == 'text' }}
        <div>
            {{ partial:statamic-easy-forms::form/fieldtypes/time }}
        </div>
        {{ /if }}

        {{# Integer #}}
        {{ if type == 'integer' }}
        <div>
            {{ partial:statamic-easy-forms::form/fieldtypes/integer }}
        </div>
        {{ /if }}

        {{# Radio #}}
        {{ if type == 'radio' }}
        <div>
            {{ partial:statamic-easy-forms::form/fieldtypes/radio }}
        </div>
        {{ /if }}

        {{# Checkboxes #}}
        {{ if type == 'checkboxes' }}
        <div>
            {{ partial:statamic-easy-forms::form/fieldtypes/checkboxes }}
        </div>
        {{ /if }}

        {{# Select #}}
        {{ if type == 'select' }}
        <div>
            {{ partial:statamic-easy-forms::form/fieldtypes/select }}
        </div>
        {{ /if }}

        {{# Textarea #}}
        {{ if type == 'textarea' }}
        <div>
            {{ partial:statamic-easy-forms::form/fieldtypes/textarea }}
        </div>
        {{ /if }}

        {{# File Upload / Assets #}}
        {{ if type == 'assets' }}
        <div>
            {{ partial:statamic-easy-forms::form/fieldtypes/file }}
        </div>
        {{ /if }}

        {{# Dictionary #}}
        {{ if type == 'dictionary' && dictionary !== 'country_phone_codes' }}
        <div>
            {{ partial:statamic-easy-forms::form/fieldtypes/dictionary }}
        </div>
        {{ /if }}

        {{# Phone codes dictionary #}}
        {{ if type == 'dictionary' && dictionary == 'country_phone_codes' }}
        <div>
            {{ partial:statamic-easy-forms::form/fieldtypes/telephone }}
        </div>
        {{ /if }}

        {{# Toggle #}}
        {{ if type == 'toggle' }}
        <div>
            {{ partial:statamic-easy-forms::form/fieldtypes/toggle }}
        </div>
        {{ /if }}

        {{# Spacer #}}
        {{ if type == 'spacer' }}
        <div>
            {{ partial:statamic-easy-forms::form/fieldtypes/spacer }}
        </div>
        {{ /if }}

        {{ if instructions && instructions_position === 'below' && type !== 'toggle' && type !== 'spacer' }}
        <div class="mt-3 text-sm">
            {{ instructions }}
        </div>
        {{ /if }}

        <div class="mt-1 text-red-600" x-show="'{{ handle }}' in errors" x-text="errors['{{ handle }}']" x-transition></div>
    </div>
    {{ /fields }}
    </div>

    <div class="w-full" x-show="! successMessage">
        <div class="my-1 text-center text-red-600" x-show="fatalError" x-cloak>
            There is a technical problem with our form. Please contact us using email.
        </div>
    </div>

    <div class="w-full py-4">
        <button
            class="relative w-full px-6 py-3.5 text-white bg-blue-600 hover:bg-blue-700 focus:ring-4 focus:outline-none uppercase font-black rounded-md text-lg xl:text-xl focus:ring-blue-600/20 text-center disabled:opacity-50 transition-all duration-300 cursor-pointer"
            x-bind:class="{ 'cursor-not-allowed opacity-50': disableSubmit }"
            type="submit"
            x-bind:disabled="disableSubmit"
            x-show="! successMessage"
        >
            <span class="text-lg xl:text-xl uppercase">{{ "Submit" | trans }}</span>
        </button>
    </div>

    <div class="text-2xl text-center my-4" x-show="successMessage" x-transition.opacity x-cloak>
        {{ "Thank you for your message! We will get back to you shortly!" | trans }}
    </div>
</form>
